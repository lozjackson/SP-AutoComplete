/********************************************************************************************************************
* SP-AutoComplete v0.1.4
*
* Modified by: Loz Jackson
* Last Modified: 2015-03-10 13:41
*
* Dependencies: 
* jquery-2.1.1.min.js (may work with other versions of jquery, but not tested)
* jquery-ui.min.js
* jquery-ui.min.css
* jquery.SPServices-2014.01.min.js (may work with other versions of jquery.SPServices, but not tested)
*
********************************************************************************************************************/
(function(n,j,k){j.AutoComplete=function(){function l(a){$(b.ACList).each(function(c,e){if(e!==k&&(a===e||-1!==e.toLowerCase().search(a.toLowerCase())))return f(!0),b.ACFormField.val(e),b.AdditionalField&&b.AdditionalFormField&&b.getAdditionalField(b.ACFormField),!1})}function f(a){if(a===k)return d;a?(a="2px inset #EEE",d=!0):(a="2px dashed red",d=!1);b.ACFormField.css("border",a);m(p);return d}function m(a){if(!b.DisableSaveButton)return!1;if(!b.ACFormField.val()||!d)a=!0;n.getElementById("Ribbon.ListForm.Edit.Commit.Publish-Large").style.display=
a?"none":"inline-block";a?g.attr("disabled",!0):g.removeAttr("disabled")}var b=this,d,g,p=!1;this.ListName=null;this.FieldName="Name";this.AdditionalField=null;this.MinLength=1;this.ACFormField="Name";this.AdditionalFormField=null;this.HostName=j.location.hostname;this.ListSite=null;this.Http="http";this.ListItemProcess=this.WebURL=null;this.DisableSaveButton=!0;this.ACList=[];this.checkField=function(a){f(!1);a&&(l(a),!f()&&0<=a.search(" ")&&(a=a.split(" "),a=a[1]+", "+a[0],l(a)))};this.getAdditionalField=
function(a){if(!a)return!1;var c=a.val().substring(a.val().indexOf("(")+1,a.val().indexOf(")"));b.AdditionalFormField&&$("input[title='"+b.AdditionalFormField+"']").val(c);a.val(a.val().replace(" ("+c+")",""))};if(arguments.length){var c=arguments[0],h;for(h in c)this[h]=c[h]}this.ListSite&&(this.WebURL=this.Http+"://"+this.HostName+"/"+this.ListSite);this.ListName&&this.ACFormField&&(b.ACList=[],b.ACFormField=$("input[title='"+b.ACFormField+"']"),g=$('input[value="Save"]'),c="<ViewFields><FieldRef Name='"+
b.FieldName+"' />",b.AdditionalField&&(c+="<FieldRef Name='"+b.AdditionalField+"' />"),c={operation:"GetListItems",listName:b.ListName,CAMLViewFields:c+"</ViewFields>",async:!1,completefunc:function(a){$(a.responseXML).SPFilterNode("z:row").each(function(){var a,c=$(this).attr("ows_"+b.FieldName);b.AdditionalField&&(a=$(this).attr("ows_"+b.AdditionalField))&&(c+=" ("+a.slice(a.indexOf("#")+1)+")");"function"===typeof b.ListItemProcess&&(c=b.ListItemProcess(c));b.ACList.push(c)})}},b.WebURL&&(c.webURL=
b.WebURL),$().SPServices(c),b.ACFormField.autocomplete({source:b.ACList,minLength:b.MinLength}),m(!0),b.ACFormField.blur(function(a){b.checkField($(a.target).val())}),b.ACFormField.keyup(function(a){13==a.keyCode&&$(a.target).blur()}))}})(document,window);