/********************************************************************************************************************
* SP-AutoComplete v0.1.0
*
* Modified by: Loz Jackson
* Last Modified: 2015-01-23 13:09
*
* Dependencies: 
* jquery-2.1.1.min.js (may work with other versions of jquery, but not tested)
* jquery-ui.min.js
* jquery-ui.min.css
* jquery.SPServices-2014.01.min.js (may work with other versions of jquery.SPServices, but not tested)
*
********************************************************************************************************************/
(function(m,g){g.AutoComplete=function(){function h(a){$(b.ACList).each(function(c,d){if(-1!==d.toLowerCase().search(a.toLowerCase()))return e(!0),b.ACFormField.val(d),b.AdditionalField&&b.AdditionalFormField&&b.getAdditionalField(b.ACFormField),!1})}function e(a){if(void 0===a)return c;a?(a="2px inset #EEE",c=!0):(a="2px dashed red",c=!1);b.ACFormField.css("border",a);k(!1);return c}function k(a){if(!b.DisableSaveButton)return!1;b.ACFormField.val()&&c||(a=!0);m.getElementById("Ribbon.ListForm.Edit.Commit.Publish-Large").style.display=
a?"none":"inline-block";a?d.attr("disabled",!0):d.removeAttr("disabled")}function n(){b.ACFormField.blur(function(a){b.checkField($(a.target).val())});b.ACFormField.keyup(function(a){13==a.keyCode&&$(a.target).blur()})}function p(){b.ACList=[];b.ACFormField=$("input[title='"+b.ACFormField+"']");d=$('input[value="Save"]');var a="<ViewFields><FieldRef Name='"+FieldName+"' />";b.AdditionalField&&(a+="<FieldRef Name='"+b.AdditionalField+"' />");a+="</ViewFields>";$().SPServices({operation:"GetListItems",
webURL:b.WebURL,listName:b.ListName,CAMLViewFields:a,async:!1,completefunc:function(a,c){$(a.responseXML).SPFilterNode("z:row").each(function(){var a,c=$(this).attr("ows_"+b.FieldName);b.AdditionalField&&(a=$(this).attr("ows_"+b.AdditionalField))&&(c+=" ("+a.slice(a.indexOf("#")+1)+")");"function"===typeof b.ListItemProcess&&(c=b.ListItemProcess(c));b.ACList.push(c)})}});b.ACFormField.autocomplete({source:b.ACList,minLength:b.MinLength,change:function(){b.AdditionalField&&b.AdditionalFormField&&b.getAdditionalField($(this))}});
k(!0);n()}var b=this,c,d;this.ListName=null;this.FieldName="Name";this.AdditionalField=null;this.MinLength=1;this.ACFormField="Name";this.AdditionalFormField=null;this.HostName=g.location.hostname;this.ListSite=null;this.Http="http";this.WebURL=this.Http+"://"+this.HostName+"/"+this.ListSite;this.ListItemProcess=null;this.DisableSaveButton=!0;this.ACList=[];this.checkField=function(a){e(!1);a&&(h(a),!e()&&0<=a.search(" ")&&(a=a.split(" "),a=a[1]+", "+a[0],h(a)))};this.getAdditionalField=function(a){if(!a)return!1;
var c=a.val().substring(a.val().indexOf("(")+1,a.val().indexOf(")"));b.AdditionalFormField&&$("input[title='"+b.AdditionalFormField+"']").val(c);a.val(a.val().replace(" ("+c+")",""))};if(arguments.length){var l=arguments[0],f;for(f in l)this[f]=l[f]}this.ListName&&this.ACFormField&&p()}})(document,window);
